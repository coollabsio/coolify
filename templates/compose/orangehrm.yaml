# documentation: https://starterhelp.orangehrm.com/hc/en-us
# slogan: Host OrangeHRM on your own infrastructure. This deployment option provides the greatest level of flexibility and control.
# tags: HR, HRIS, HRMS, human resource management, OrangeHRM, HR management
# logo: svgs/orangehrm.svg

services:
  orangehrm:
    image: 'orangehrm/orangehrm:latest'
    environment:
      - SERVICE_FQDN_ORANGEHRM_80
      - ORANGEHRM_DATABASE_HOST=mariadb
      - ORANGEHRM_DATABASE_USER=${SERVICE_USER_ORANGEHRM}
      - ORANGEHRM_DATABASE_PASSWORD=${SERVICE_PASSWORD_ORANGEHRM}
      - ORANGEHRM_DATABASE_NAME=${MARIADB_DATABASE:-orangehrm}
    volumes:
      - 'orangehrm-data:/orangehrm'
    depends_on:
      - mariadb
    links:
      - 'mariadb:mariadb'
    healthcheck:
      test:
        - CMD
        - curl
        - '-f'
        - 'http://127.0.0.1'
      interval: 2s
      timeout: 10s
      retries: 10
  mariadb:
    image: 'mariadb:10.11'
    restart: unless-stopped
    volumes:
      - 'mariadb-data:/var/lib/mysql'
    environment:
      - MARIADB_ROOT_PASSWORD=${SERVICE_PASSWORD_ROOT}
      - MARIADB_DATABASE=${MARIADB_DATABASE:-orangehrm}
      - MARIADB_USER=${SERVICE_USER_ORANGEHRM}
      - MARIADB_PASSWORD=${SERVICE_PASSWORD_ORANGEHRM}
    healthcheck:
      test:
        - CMD
        - healthcheck.sh
        - '--connect'
        - '--innodb_initialized'
      interval: 5s
      timeout: 20s
      retries: 10
